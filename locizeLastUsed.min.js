!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.locizeLastUsed=e()}(this,function(){"use strict";function t(t,e,n){var i;return function(){var s=this,o=arguments,r=function(){i=null,n||t.apply(s,o)},u=n&&!i;clearTimeout(i),i=setTimeout(r,e),u&&t.apply(s,o)}}function e(t,e,n){var i=t;return e.forEach(function(t){var e=new RegExp("{{"+t+"}}","g");i=i.replace(e,n[t])}),i}function n(t,e,n,i,s){try{var o=new(XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");o.open(i?"POST":"GET",t,1),e.crossDomain||o.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.authorize&&e.apiKey&&o.setRequestHeader("Authorization",e.apiKey),(i||e.setContentTypeJSON)&&o.setRequestHeader("Content-type","application/json"),o.onreadystatechange=function(){o.readyState>3&&n&&n(o.responseText,o)},o.send(JSON.stringify(i))}catch(t){window.console&&console.log(t)}}function i(){return{lastUsedPath:"https://api.locize.io/used/{{projectId}}/{{version}}/{{lng}}/{{ns}}",referenceLng:"en",crossDomain:!0,setContentTypeJSON:!1,version:"latest",debounceSubmit:"90000"}}var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o={init:function(e){var n=e.t&&"function"==typeof e.t;this.options=n?s({},i(),this.options,e.options.locizeLastUsed):s({},i(),this.options,e),this.submitting=null,this.pending={},this.done={},this.submit=t(this.submit,this.options.debounceSubmit),n&&this.interceptI18next(i18next)},interceptI18next:function(t){var e=this,n=t.services.resourceStore.getResource;t.services.resourceStore.getResource=function(i,s,o,r){return o&&e.used(s,o),n.call(t.services.resourceStore,i,s,o,r)}},used:function(t,e){var n=this;["pending","done"].forEach(function(i){n.done[t]&&n.done[t][e]||(n[i][t]||(n[i][t]={}),n[i][t][e]=!0)}),this.submit()},submit:function(){var t=this;if(this.submitting)return this.submit();this.submitting=this.pending,this.pending={};var i=e(this.options.lastUsedPath,["projectId","version","lng","ns"],s({},this.options,{lng:this.options.referenceLng})),o=Object.keys(this.submitting),r=o.length,u=function(){--r||(t.submitting=null)};o.forEach(function(e){var o=Object.keys(t.submitting[e]);o.length?n(i,s({authorize:!0},t.options),function(t,e){u()},o):u()})}};return o.type="3rdParty",o});
